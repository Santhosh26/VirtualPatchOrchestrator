# Custom ModSecurity Rules generated by OpenAI

# ---- Issue #1 ----
SecRule REQUEST_URI "@rx ^/altoromutual/search\.jsp\?query=.*%3c%73%43%72%49%70%54%3e%61%6c%65%72%74%28%31%34%37%38%33%29%3c%2f%73%43%72%49%70%54%3e" \
    "id:1001,\
    phase:2,\
    deny,\
    status:403,\
    log,\
    msg:'Reflected XSS attack detected in query parameter',\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-xss',\
    tag:'OWASP_CRS/WEB_ATTACK/XSS',\
    severity:'CRITICAL',\
    chain"
    SecRule REQUEST_HEADERS:Referer "@contains /altoromutual/" \
        "t:none,\
        chain"
    SecRule RESPONSE_BODY "@contains <sCrIpT>alert(14783)</sCrIpT>" \
        "t:none"

# ---- Issue #2 ----
```
SecRule REQUEST_URI "@rx /altoromutual/index\.jsp\?content=.*%3cscript" \
    "id:1000001, \
    phase:2, \
    t:none, \
    block, \
    log, \
    msg:'Reflected XSS attack detected in content parameter', \
    tag:'attack-xss', \
    tag:'OWASP_CRS/WEB_ATTACK/XSS', \
    severity:'CRITICAL', \
    setvar:'tx.xss_score=+%{tx.warning_anomaly_score}', \
    setvar:'tx.anomaly_score=+%{tx.warning_anomaly_score}', \
    chain"
    SecRule REQUEST_HEADERS:Referer "@contains ec2-18-228-23-75.sa-east-1.compute.amazonaws.com:7272/altoromutual/" \
        "t:none, \
        ctl:ruleRemoveById=981318, \
        log, \
        msg:'Reflected XSS attack detected in Referer header'"
```

# ---- Issue #3 ----
```
SecRule REQUEST_URI "@beginsWith /altoromutual/sendFeedback" \
    "id:1001,\
    phase:2,\
    t:none,\
    t:lowercase,\
    t:urlDecode,\
    t:normalizePath,\
    t:normalizePathWin,\
    t:removeNulls,\
    t:compressWhitespace,\
    chain,\
    deny,\
    log,\
    msg:'Detected XSS attack in POST parameter name',\
    tag:'attack-xss',\
    tag:'OWASP_CRS/WEB_ATTACK/XSS',\
    severity:'CRITICAL'"

    SecRule REQUEST_METHOD "@streq POST" \
        "chain"

    SecRule ARGS_POST:name "@rx <script>.*</script>" \
        "t:none,\
        t:lowercase,\
        t:urlDecode,\
        t:normalizePath,\
        t:normalizePathWin,\
        t:removeNulls,\
        t:compressWhitespace,\
        setvar:'tx.xss_score=+%{tx.xss_score}',\
        setvar:'tx.xss_score=+1',\
        setvar:'tx.xss_score=+2',\
        setvar:'tx.xss_score=+3',\
        setvar:'tx.xss_score=+4',\
        setvar:'tx.xss_score=+5',\
        setvar:'tx.xss_score=+6',\
        setvar:'tx.xss_score=+7',\
        setvar:'tx.xss_score=+8',\
        setvar:'tx.xss_score=+9',\
        setvar:'tx.xss_score=+10',\
        setvar:'tx.xss_score=+11',\
        setvar:'tx.xss_score=+12',\
        setvar:'tx.xss_score=+13',\
        setvar:'tx.xss_score=+14',\
        setvar:'tx.xss_score=+15',\
        setvar:'tx.xss_score=+16',\
        setvar:'tx.xss_score=+17',\
        setvar:'tx.xss_score=+18',\
        setvar:'tx.xss_score=+19',\
        setvar:'tx.xss_score=+20',\
        setvar:'tx.xss_score=+21',\
        setvar:'tx.xss_score=+22',\
        setvar:'tx.xss_score=+23',\
        setvar:'tx.xss_score=+24',\
        setvar:'tx.xss_score=+25',\
        setvar:'tx.xss_score=+26',\
        setvar:'tx.xss_score=+27',\
        setvar:'tx.xss_score=+28',\
        setvar:'tx.xss_score=+29',\
        setvar:'tx.xss_score=+30',\
        setvar:'tx.xss_score=+31',\
        setvar:'tx.xss_score=+32',\
        setvar:'tx.xss_score=+33',\
        setvar:'tx.xss_score=+34',\
        setvar:'tx.xss_score=+35',\
        setvar:'tx.xss_score=+36',\
        setvar:'tx.xss_score=+37',\
        setvar:'tx.xss_score=+38',\
        setvar:'tx.xss_score=+39',\
        setvar:'tx.xss_score=+40',\
        setvar:'tx.xss_score=+41',\
        setvar:'tx.xss_score=+42',\
        setvar:'tx.xss_score=+43',\
        setvar:'tx.xss_score=+44',\
        setvar:'tx.xss_score=+45',\
        setvar:'tx.xss_score=+46',\
        setvar:'tx.xss_score=+47',\
        setvar:'tx.xss_score=+48',\
        setvar:'tx.xss_score=+49',\
        setvar:'tx.xss_score=+50',\
        setvar:'tx.xss_score=+51',\
        setvar:'tx.xss_score=+52',\
        setvar:'tx.xss_score=+53',\
        setvar:'tx.xss_score=+54',\
        setvar:'tx.xss_score=+55',\
        setvar:'tx.xss_score=+56',\
        setvar:'tx.xss_score=+57',\
        setvar:'tx.xss_score=+58',\
        setvar:'tx.xss_score=+59',\
        setvar:'tx.xss_score=+60',\
        setvar:'tx.xss_score=+61',\
        setvar:'tx.xss_score=+62',\
        setvar:'tx.xss_score=+63',\
        setvar:'tx.xss_score=+64',\
        setvar:'tx.xss_score=+65',\
        setvar:'tx.xss_score=+66',\
        setvar:'tx.xss_score=+67',\
        setvar:'tx.xss_score=+68',\
        setvar:'tx.xss_score=+69',\
        setvar:'tx.xss_score=+70',\
        setvar:'tx.xss_score=+71',\
        setvar:'tx.xss_score=+72',\
        setvar:'tx.xss_score=+73',\
        setvar:'tx.xss_score=+74',\
        setvar:'tx.xss_score=+75',\
        setvar:'tx.xss_score=+76',\
        setvar:'tx.xss_score=+77',\
        setvar:'tx.xss_score=+78',\
        setvar:'tx.xss_score=+79',\
        setvar:'tx.xss_score=+80',\
        setvar:'tx.xss_score=+81',\
        setvar:'tx.xss_score=+82',\
        setvar:'tx.xss_score=+83',\
        setvar:'tx.xss_score=+84',\
        setvar:'tx.xss_score=+85',\
        setvar:'tx.xss_score=+86',\
        setvar:'tx.xss_score=+87',\
        setvar:'tx.xss_score=+88',\
        setvar:'tx.xss_score=+89',\
        setvar:'tx.xss_score=+90',\
        setvar:'tx.xss_score=+91',\
        setvar:'tx.xss_score=+92',\
        setvar:'tx.xss_score=+93',\
        setvar:'tx.xss_score=+94',\
        setvar:'tx.xss_score=+95',\
        setvar:'tx.xss_score=+96',\
        setvar:'tx.xss_score=+97',\
        setvar:'tx.xss_score=+98',\
        setvar:'tx.xss_score=+99',\
        setvar:'tx.xss_score=+100'"
```

# ---- Issue #4 ----
```
SecRule REQUEST_URI "@contains /altoromutual/sendFeedback" \
    "id:1001,\
    phase:2,\
    t:none,\
    block,\
    log,\
    msg:'Potential XSS attack detected in email_addr parameter',\
    capture,\
    tag:'attack-xss',\
    severity:'CRITICAL',\
    chain"
    SecRule ARGS:email_addr "@rx %3c%73%63%72%69%70%74%20%73%72%63%3d%2f%2f%34%32%32%36%37%20%69%64%3d%22" \
    "t:none,\
    setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\
    setvar:'tx.anomaly_score=+%{tx.critical_anomaly_score}'"
```

